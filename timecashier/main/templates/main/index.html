{% extends "main/base.html" %}

{% load crispy_forms_tags %}

{% block title %}Home{% endblock %}

{% block content %}

<h2>Dashboard</h2>
<p>Jesteś w pobliżu {{ nearest_client }}</p>
<div class="row" style="margin-top: 30px; padding: 10px;">
<form method="POST">
{% csrf_token %}
    <label for="start">Start:</label><br>
    <input type="datetime-local" id="start" name="start"><br>

    <label for="end">Koniec:</label><br>
    <input type="datetime-local" id="end" name="end"><br>

    <label for="id_client">Klient (na podstawie lokalizacji):</label><br>
    <select name="client" id="id_client"  value="{{ nearest_client }}">
        {% for client in clients_list %}
        {% if client.id == nearest_client.id %}
        <option value="{{ client.id }}" selected>{{ client.name }}</option>
        {% else %}
        <option value="{{ client.id }}">{{ client.name }}</option>
        {% endif %}
        {% endfor %}
    </select><br>

    <button class="btn btn btn-primary" type="submit">DODAJ</button>
</form>
</div>
<div class="row border" style="margin-top: 30px; padding: 10px;">
<form>
    {% crispy form form.helper %}
</form>
</div>
<div class="row" style="margin-top: 30px; padding: 10px;">
    <h4>Aktywne zadania</h4>
    <table id="table_active_entries" class="table table-striped table-dark">
        <thead><th>Klient</th><th>Czas rozpoczęcia</th><th>Czas zakończenia</th></thead>
        <tbody>
        {% for entry in active_entries %}
        <tr><td>{{ entry.client.name }}</td><td>{{ entry.start }}</td><td>{{ entry.end }}</td></tr>
        {% endfor %}
        </tbody>
    </table>
    <script>
let table = new DataTable('#table_active_entries', {
    "pageLength":5,
    "order": [[ 0, "asc" ]],
    "searching": false,
    "paging": true,
    "info": false,
    "lengthChange":false

});
</script>
</div>

{% endblock %}